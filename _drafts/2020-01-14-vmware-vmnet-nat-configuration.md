---
layout: post
title: VMware Player在Windows系统下使用NAT模式的端口映射
categories: [VMware, Windows, NAT]
description: VMware Player不同于其专业版平台，它不存在网络设置工具相关的功能，所以如果想要使用专业版平台一样的NAT模式端口映射，需要自行修改配置文件。
keywords: VMware, Windows, NAT, Port-Mapping
---

``VMware Player``在功能完整性不如其专业版本``VMware Workstation Pro``，在``VMware Player``中不存在网络设置的相关工具和其他一些常用功能。但是，``VMware Player``是免费版本，并且具有核心的虚拟机安装和播放的功能。于是，因为穷（误……），我毅然决然地选择使用``VMware Player``。不过，由于需要在虚拟机中搭建Web服务器，如果不做NAT模式的端口映射，宿主机和同一局域网下的其他PC是无法直接访问虚拟机中的Web服务的，所以在``VMware Player``下使用NAT模式的端口映射还是一件必须的事情。


## 设置虚拟机nat共享的网卡为固定ip
vmware虚拟机使用nat网络时，是VMware Network Adapter VMnet8网卡提供的nat服务。查看VMware Network Adapter VMnet8网卡的网址，比如我的是：

192.168.20.1

255.255.255.0

此时可以在虚拟机中将nat的那个网卡设置固定ip地址：

比如我的debian机器：

在终端中输入 nano /etc/network/interfaces

具体设置为：

auto lo

iface lo inet loopbook

auto eth0

iface etho inet static

address 192.168.20.56

netmask 255.255.255.0

gateway 192.168.20.2

broadcast 192.168.20.255

--说明，broadcast可以先设置成自动获取时查看ipconfig

保存后。然后编辑：/etc/resolv.conf，设置dns

# Generated by NetworkManager
nameserver 202.38.64.7
nameserver 202.38.64.1

/etc/init.d/networking restart 重启网卡

然后按下面的设置来设置虚拟机nat网络的端口映射

 

2. 给虚拟机nat网卡开启端口映射
在VMware Player中,并不像VMware Station中提供网络编辑功能,因此如果想使用port forward功能,则需要进行手动配置.

例如在Windows xp操作系统中,找到vmware nat的配置文件：

C:\Documents and Settings\All Users\Application Data\VMware\vmnetnat.conf

在windows 7系统中，vmware nat的配置文件在：

C:\ProgramData\VMware\vmnetnat.conf

如果想使用TCP,则修改其[incomingtcp]下面的配置选项,如：

8888 = 192.168.20.56:80

其意思是将主机的8888端口映射到虚拟机的80端口,这样其它的机器只要访问这台主机的8888端口,就可以访问到其虚拟机的80端口了

比如我的是增加了一下几项：

22:192.168.20.56:22  （ssh端口）

80:192.168.20.56:80   （将虚拟机的80端口映射到主机的80端口，这样的话，主机上不能再使用80端口）

 

最后需要在主机上重新启动一下vmware NAT service服务,然后就可以正常访问了.

服务的查看方法，在cmd中执行：

sc query|find /i "vmware"

执行后发现有如下服务名：

DISPLAY_NAME: VMware Authorization Service

DISPLAY_NAME: VMware DHCP Service

DISPLAY_NAME: VMware USB Arbitration Service

SERVICE_NAME: VMware NAT Service

DISPLAY_NAME: VMware NAT Service

在cmd中使用net stop "VMware NAT Service"&net start "VMware NAT Service"命令可以重启服务。

注:如果访问不了,请查看Windows防火墙是否阻止了这些端口.